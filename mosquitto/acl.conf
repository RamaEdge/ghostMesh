# GhostMesh MQTT Access Control List (ACL)
# Defines topic permissions for each service user

# Gateway user - can write telemetry and state data
user gateway
topic write factory/#
topic write state/#
topic read factory/#

# Detector user - can read telemetry and write alerts
user detector
topic read factory/#
topic write alerts/#
topic read state/#

# Explainer user - can read alerts and write explanations
user explainer
topic read alerts/#
topic write explanations/#

# Policy user - can read alerts and control commands, write audit logs
user policy
topic read alerts/#
topic read control/#
topic write audit/#
topic read explanations/#

# Dashboard user - can read all data and write control commands
user dashboard
topic read factory/#
topic read alerts/#
topic read explanations/#
topic read state/#
topic read audit/#
topic write control/#

# IoT user - general purpose user for testing and development
user iot
topic read factory/#
topic read alerts/#
topic read explanations/#
topic read state/#
topic read audit/#
topic write control/#
topic write factory/#
topic write alerts/#
